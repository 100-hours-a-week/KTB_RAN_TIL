앱라우터 충돌

Feature-Sliced Design(FSD)를 Next.js와 함께 사용할 때 발생하는 가장 큰 과제는 **Next.js의 파일 기반 라우팅 시스템과 FSD의 레이어 구조 사이의 명칭 및 역할 충돌**을 해결하는 것입니다.

소스에 따르면, **루트 `app` 폴더 유지**를 통한 레이어 충돌 해결 방안은 다음과 같은 맥락에서 논의됩니다.

### 1. 레이어 충돌의 원인: 프레임워크와 아키텍처의 철학 차이
Next.js(특히 App Router)는 프로젝트의 `app` 폴더를 통해 애플리케이션의 경로(Route)를 정의하며, 폴더 구조가 곧 URL 경로가 되기를 기대합니다. 반면, FSD 아키텍처에서 `app` 레이어는 앱의 진입점과 전역 설정을 담당하는 독립적인 계층이며, 내부적으로 평면적인 슬라이스 구조를 유지해야 합니다. 이러한 **라우팅 매커니즘과 아키텍처적 계층 구조의 불일치**가 충돌의 핵심입니다.

### 2. 해결책: 루트 `app` 폴더를 통한 "라우팅 프록시" 역할 수행
이 충돌을 해결하기 위해 소스는 **Next.js의 라우팅용 `app` 폴더를 프로젝트 루트에 배치**하고, 실제 비즈니스 로직과 FSD 레이어는 **`src` 폴더** 내부로 격리하는 전략을 제시합니다.

*   **구조적 분리**: 루트 레벨의 `app` 폴더는 오직 **라우팅 정의**만을 담당하며, 실제 페이지의 구현체는 `src/pages` 레이어에 위치시킵니다.
*   **재내보내기(Re-exporting) 기법**: 루트 `app` 폴더 내의 `page.tsx` 파일에서는 비즈니스 로직을 작성하지 않고, **`src/pages` 레이어에서 정의된 페이지 컴포넌트를 가져와 단순히 내보내는(export) 역할**만 수행합니다.
    *   *예시*: `app/example/page.tsx`에서 `export { ExamplePage as default } from '@/pages/example';`와 같이 작성합니다.

### 3. 레이어 충돌 해결을 위한 추가적인 루트 구성
단순히 `app` 폴더를 분리하는 것 외에도, Next.js의 작동 방식과 충돌하지 않기 위해 몇 가지 추가적인 조치가 필요합니다.

*   **빈 `pages` 폴더 생성**: App Router를 사용하더라도 프로젝트 루트에 **빈 `pages` 폴더**를 만들어야 합니다. 그렇지 않으면 Next.js가 `src/pages`를 Pages Router로 오인하여 빌드 오류를 일으킬 수 있기 때문입니다. 소스는 이 폴더가 왜 비어 있는지 설명하는 `README.md`를 넣어둘 것을 권장합니다.
*   **미들웨어 및 계측(Instrumentation) 위치**: 프로젝트에서 `middleware.js`나 `instrumentation.js`를 사용하는 경우, 이들은 FSD 레이어 내부가 아니라 **루트 `app` 및 `pages` 폴더와 나란히 프로젝트 루트**에 위치해야 합니다.
*   **API 경로 처리**: API 라우트(Route Handlers)의 경우, 실제 로직은 `src/app/api-routes` 세그먼트에 작성하고, 루트 `app/api/.../route.ts`에서 이를 호출하여 사용함으로써 일관성을 유지합니다.

### 4. 이 전략의 의의
이러한 구성을 통해 개발자는 **Next.js의 강력한 라우팅 기능을 유지하면서도, FSD의 엄격한 레이어 참조 규칙과 슬라이스 격리 원칙을 지킬 수 있습니다**. 즉, 루트 폴더들은 프레임워크를 위한 '접점' 역할을 하고, `src` 폴더 내부는 순수한 아키텍처적 '설계'를 따르는 구조가 되어 레이어 간의 충돌을 깔끔하게 해소합니다.


![NotebookLM Mind Map.png](images/NotebookLM%20Mind%20Map.png)